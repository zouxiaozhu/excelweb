# 表格快搜功能说明

## 功能概述

表格快搜是一个支持分享的Excel数据查询功能，允许用户通过分享链接直接访问和搜索Excel文件中的数据，无需登录即可使用。

## 主要特性

### 1. 分享功能
- 在表格快查页面的任务列表中，每个任务都有一个"分享"按钮
- 点击分享按钮后，系统会生成一个包含文件编码的分享链接
- 分享链接会自动复制到剪贴板，方便用户分享给其他人

### 2. 简洁界面
- 移除了导航栏和底部，专注于搜索功能
- 添加了简洁的页面标题，提供清晰的功能说明
- 适合作为分享页面使用，界面简洁明了
- 无需登录即可直接使用
- 全屏搜索体验，无干扰元素

### 3. 移动端兼容
- 完全响应式设计，支持手机、平板、桌面设备
- 移动端优化的搜索界面和表格显示
- 触摸友好的按钮和输入框设计

### 4. 搜索功能
- 动态生成搜索字段，根据Excel文件的实际列结构
- 支持多条件搜索，字段根据文件内容自动适配
- 实时搜索结果显示
- 支持导出搜索结果到CSV文件
- 使用新的搜索API，支持精确匹配

## 使用方法

### 生成分享链接
1. 进入表格快查页面
2. 在任务列表中找到要分享的任务
3. 点击"分享"按钮
4. 系统会显示分享链接并自动复制到剪贴板
5. 将链接分享给其他人

### 使用分享链接
1. 打开分享链接（格式：`/excel-search?fileCoding=文件编码`）
2. 在搜索条件中输入要查询的内容
3. 点击"Q搜索"按钮
4. 查看搜索结果，支持分页浏览
5. 可选择导出搜索结果

## 技术实现

### 路由配置
```typescript
{
  path: '/excel-search',
  name: 'ExcelSearch',
  component: () => import('../pages/ExcelSearch.vue'),
  meta: {
    title: '表格快搜 - Excel Web'
  }
}
```

### 布局控制
- 在 `App.vue` 中根据路由条件控制 `TopStatusBar` 和 `Footer` 的显示
- 表格快搜页面不显示导航栏和底部，提供全屏搜索体验

### 性能优化
- 表格快搜页面跳过用户状态检查和token验证
- 减少不必要的API调用，提升页面加载速度
- 适合作为分享页面使用，无需登录验证

### 分享链接格式
```
https://your-domain.com/excel-search?fileCoding=5a6649359d554885
```

### API接口
- `GET /excel/meta?fileCoding={fileCoding}` - 获取Excel文件元数据
- `POST /excel/searchRows` - 搜索Excel数据
- 支持多条件搜索，使用AND逻辑

### 响应式设计
- 桌面端：自适应列布局（根据字段数量）
- 平板端：自适应列布局
- 移动端：单列布局
- 动态网格布局，自动适配不同数量的搜索字段

## 文件结构

```
src/
├── pages/
│   └── ExcelSearch.vue          # 表格快搜页面
├── services/
│   └── api.ts                   # API接口（包含searchExcelData）
└── router/
    └── index.ts                 # 路由配置
```

## 样式特点

### 移动端优化
- 使用CSS Grid和Flexbox实现响应式布局
- 针对不同屏幕尺寸的媒体查询
- 移动端表格字体和间距优化
- 触摸友好的按钮尺寸

### 用户体验
- 清晰的视觉层次
- 直观的操作流程
- 友好的错误提示
- 加载状态指示

## 测试

可以使用 `test-share-link.html` 文件测试分享功能：
1. 生成分享链接
2. 测试复制到剪贴板
3. 验证链接访问
4. 检查移动端兼容性

## 注意事项

1. 分享链接不需要登录即可访问
2. 文件编码是链接的唯一标识
3. 搜索结果支持分页，默认每页20条
4. 导出功能支持CSV格式
5. 移动端建议使用竖屏模式获得最佳体验

## 未来扩展

- 支持更多搜索条件
- 添加搜索历史记录
- 支持高级搜索语法
- 增加数据可视化功能
- 支持多文件对比搜索
